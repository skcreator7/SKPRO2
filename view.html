<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="shortcut icon" href="https://iili.io/KOlfc41.png" type="image/x-icon">
    <meta name="referrer" content="no-referrer-when-downgrade" />
    <meta property="og:image" content="https://iili.io/KOlfc41.png" itemprop="thumbnailUrl">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>SK4FiLM - Live Channels</title>
    
    <!-- Shaka Player CSS & JS -->
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.7.11/controls.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.7.11/shaka-player.compiled.min.js"></script>
    
    <!-- Existing Libraries -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/wow/1.1.2/wow.min.js"></script>    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* Reset & Base */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        :root {
            --primary-red: #ff0000;
            --primary-blue: #0066ff;
            --dark-bg: #0a0a0f;
            --darker-bg: #05050a;
            --control-bg: rgba(0, 0, 0, 0.8);
            --accent: #00ccff;
            --primary: #ff0000;
            --secondary: #0066ff;
        }
        
        html, body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: var(--dark-bg);
            color: #fff;
            min-height: 100vh;
            width: 100%;
            overflow-x: hidden;
            -webkit-overflow-scrolling: touch;
        }
        
        body {
            overflow-y: auto;
            height: auto;
            position: relative;
            padding-top: 70px;
        }
        
        /* Navigation */
        .top-navbar {
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(15px);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            width: 100%;
            z-index: 1000;
            padding: 12px 0;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        }
        
        .navbar-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
            position: relative;
            padding: 0 15px;
            max-width: 100%;
        }
        
        .logo-section {
            display: flex;
            align-items: center;
            flex-shrink: 0;
            max-width: 60%;
        }
        
        .logo-img {
            height: 40px;
            width: 40px;
            margin-right: 8px;
            border-radius: 8px;
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.3);
            object-fit: contain;
        }
        
        .brand-content {
            min-width: 0;
            flex: 1;
        }
        
        .brand-text {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.3rem;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1.2;
            white-space: nowrap;
        }
        
        .brand-subtitle {
            font-size: 0.6rem;
            color: var(--accent);
            font-weight: 300;
            letter-spacing: 0.5px;
            font-style: italic;
            white-space: nowrap;
        }
        
        .action-buttons {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-shrink: 0;
        }
        
        .search-icon-btn {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            width: 42px;
            height: 42px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 0, 0, 0.4);
        }
        
        .search-icon-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 25px rgba(255, 0, 0, 0.6);
        }
        
        .menu-button {
            background: rgba(0, 204, 255, 0.15);
            border: 2px solid var(--accent);
            color: var(--accent);
            padding: 9px 11px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .menu-button:hover {
            background: rgba(0, 204, 255, 0.25);
            box-shadow: 0 0 20px rgba(0, 204, 255, 0.6);
        }
        
        .menu-lines {
            display: flex;
            flex-direction: column;
            gap: 3px;
        }
        
        .menu-line {
            width: 18px;
            height: 2px;
            background: var(--accent);
            border-radius: 2px;
            transition: all 0.3s ease;
        }
        
        .menu-button.active .menu-line:nth-child(1) {
            transform: rotate(45deg) translate(5px, 5px);
        }
        
        .menu-button.active .menu-line:nth-child(2) {
            opacity: 0;
        }
        
        .menu-button.active .menu-line:nth-child(3) {
            transform: rotate(-45deg) translate(5px, -5px);
        }
        
        .search-container {
            position: fixed;
            top: 70px;
            left: 0;
            right: 0;
            z-index: 999;
            background: rgba(15, 23, 42, 0.98);
            border-bottom: 2px solid var(--accent);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
            padding: 0 15px;
            max-height: 0;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .search-container.active {
            max-height: 85px;
            padding: 15px;
        }
        
        .search-wrapper {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .inline-search-input {
            flex: 1;
            background: rgba(60, 65, 90, 0.9);
            border: 2px solid var(--accent);
            color: white;
            padding: 10px 15px;
            font-size: 0.9rem;
            border-radius: 25px;
            outline: none;
        }
        
        .inline-search-input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }
        
        .inline-search-input:focus {
            box-shadow: 0 0 15px rgba(0, 204, 255, 0.5);
            border-color: #00e6ff;
        }
        
        .inline-search-btn {
            background: var(--accent);
            color: #1a1a2e;
            border: none;
            padding: 10px 16px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        .inline-search-btn:hover {
            background: #00b8e6;
        }
        
        .menu-section {
            position: relative;
        }
        
        .menu-dropdown {
            position: fixed;
            top: 70px;
            right: 15px;
            left: 15px;
            background: linear-gradient(135deg, rgba(15, 23, 42, 0.98), rgba(30, 41, 59, 0.98));
            border: 2px solid var(--accent);
            border-radius: 15px;
            padding: 20px;
            max-height: 0;
            overflow: hidden;
            opacity: 0;
            transition: all 0.3s ease;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            z-index: 998;
        }
        
        .menu-dropdown.active {
            max-height: 350px;
            opacity: 1;
        }
        
        .menu-dropdown h4 {
            color: var(--accent);
            margin-bottom: 15px;
            font-size: 1.2rem;
            text-align: center;
        }
        
        .menu-links {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .menu-link {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 15px;
            background: rgba(0, 204, 255, 0.1);
            border: 1px solid rgba(0, 204, 255, 0.3);
            border-radius: 10px;
            color: white;
            text-decoration: none;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        .menu-link:hover {
            background: rgba(0, 204, 255, 0.2);
            transform: translateX(5px);
        }
        
        .menu-link i {
            font-size: 1.2rem;
            width: 25px;
            text-align: center;
        }
        
        @media (min-width: 992px) {
            body {
                padding-top: 90px;
            }
            
            .search-container {
                top: 90px;
            }
            
            .menu-dropdown {
                top: 90px;
            }
        }
        
        /* Main Container */
        .main-container {
            width: 100%;
            min-height: calc(100vh - 70px);
            position: relative;
        }
        
        /* Video Wrapper */
        .video-wrapper {
            width: 100%;
            position: relative;
            background: #000;
            margin: 0;
        }
        
        .aspect-ratio-box {
            position: relative;
            width: 100%;
            padding-top: 56.25%;
            background: #000;
        }
        
        .video-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            cursor: pointer;
            overflow: hidden;
        }
        
        /* Shaka Player Styling */
        #video-element {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            object-fit: contain;
            background: #000;
        }
        
        /* Hide Shaka's default controls - we'll use custom controls */
        .shaka-text-container {
            display: none;
        }
        
        /* Fullscreen styles */
        :fullscreen .video-wrapper,
        :-webkit-full-screen .video-wrapper,
        :-moz-full-screen .video-wrapper,
        :-ms-fullscreen .video-wrapper {
            width: 100vw;
            height: 100vh;
            padding-top: 0 !important;
            margin: 0 !important;
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            z-index: 999999 !important;
            background: #000 !important;
        }
        
        :fullscreen .aspect-ratio-box,
        :-webkit-full-screen .aspect-ratio-box,
        :-moz-full-screen .aspect-ratio-box,
        :-msfullscreen .aspect-ratio-box {
            width: 100vw !important;
            height: 100vh !important;
            padding-top: 0 !important;
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
        }
        
        :fullscreen .video-container,
        :-webkit-full-screen .video-container,
        :-moz-full-screen .video-container,
        :-msfullscreen .video-container {
            width: 100vw !important;
            height: 100vh !important;
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            z-index: 999999 !important;
        }
        
        :fullscreen #video-element,
        :-webkit-full-screen #video-element,
        :-moz-full-screen #video-element,
        :-msfullscreen #video-element {
            width: 100vw !important;
            height: 100vh !important;
            object-fit: contain !important;
        }
        
        :fullscreen .content-section,
        :-webkit-full-screen .content-section,
        :-moz-full-screen .content-section,
        :-msfullscreen .content-section {
            display: none !important;
        }
        
        /* Gesture Indicators */
        .gesture-indicator {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 15px;
            border-radius: 50%;
            z-index: 200;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .brightness-indicator {
            left: 30px;
        }
        
        .volume-indicator {
            right: 30px;
        }
        
        .gesture-indicator.show {
            display: flex;
            animation: fadeInOut 2s ease;
        }
        
        .gesture-value {
            position: absolute;
            top: -40px;
            background: rgba(0, 0, 0, 0.8);
            padding: 5px 10px;
            border-radius: 10px;
            font-size: 0.9rem;
            white-space: nowrap;
        }
        
        /* Side Click Areas */
        .side-click-area {
            position: absolute;
            top: 0;
            height: 100%;
            width: 30%;
            z-index: 40;
        }
        
        .left-click-area {
            left: 0;
        }
        
        .right-click-area {
            right: 0;
        }
        
        /* Play Overlay */
        .play-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 70px;
            height: 70px;
            background: linear-gradient(135deg, var(--primary-red), var(--primary-blue));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            color: white;
            cursor: pointer;
            opacity: 1;
            transition: opacity 0.3s, transform 0.3s;
            z-index: 50;
            border: 3px solid white;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        .play-overlay.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        /* Custom Video Controls */
        .video-controls {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(transparent, rgba(0, 0, 0, 0.9));
            padding: 12px 15px;
            display: flex;
            align-items: center;
            gap: 12px;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 100;
            transform: translateY(100%);
        }
        
        .video-controls.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        .control-btn {
            background: none;
            border: none;
            color: white;
            font-size: 1.1rem;
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.2s;
        }
        
        .control-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .play-pause-btn {
            background: linear-gradient(135deg, var(--primary-red), var(--primary-blue));
            width: 45px;
            height: 45px;
        }
        
        .time-display {
            color: white;
            font-size: 0.85rem;
            font-family: monospace;
            min-width: 100px;
            text-align: center;
        }
        
        .progress-container {
            flex: 1;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            overflow: hidden;
            cursor: pointer;
            position: relative;
            margin: 0 10px;
        }
        
        .buffer-bar {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            background: rgba(255, 255, 255, 0.2);
            width: 0%;
            border-radius: 3px;
            transition: width 0.2s;
        }
        
        .progress-bar {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            background: linear-gradient(90deg, var(--primary-red), var(--primary-blue));
            width: 0%;
            border-radius: 3px;
            z-index: 2;
            transition: width 0.1s;
        }
        
        .progress-thumb {
            position: absolute;
            top: 50%;
            transform: translate(-50%, -50%);
            width: 12px;
            height: 12px;
            background: white;
            border-radius: 50%;
            z-index: 3;
            opacity: 0;
            transition: opacity 0.2s;
            border: 2px solid var(--primary-red);
        }
        
        .progress-container:hover .progress-thumb {
            opacity: 1;
        }
        
        .fullscreen-btn {
            margin-left: auto;
        }
        
        /* Ad Container */
        .ad-container {
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0 0 15px 0;
            min-height: 90px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            overflow: hidden;
        }
        
        .ad-desktop {
            display: none;
        }
        
        .ad-mobile {
            display: block;
        }
        
        @media (min-width: 768px) {
            .ad-desktop {
                display: block;
            }
            
            .ad-mobile {
                display: none;
            }
        }
        
        /* Category Section */
        .category-section {
            margin: 20px 0;
            padding: 0 10px;
        }
        
        .category-title {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 15px;
            padding-left: 10px;
            border-left: 4px solid var(--primary-red);
            color: #fff;
        }
        
        .channels-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 12px;
            padding: 5px;
        }
        
        .channel-card {
            background: linear-gradient(145deg, #1a1a2e, #16213e);
            border-radius: 12px;
            padding: 12px 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 0, 0, 0.2);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            position: relative;
        }
        
        .channel-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary-red);
            box-shadow: 0 8px 25px rgba(255, 0, 0, 0.3);
        }
        
        .channel-logo {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            object-fit: cover;
            margin-bottom: 8px;
            border: 2px solid var(--primary-red);
            background: white;
        }
        
        .channel-name {
            font-size: 0.8rem;
            font-weight: 600;
            text-align: center;
            color: #fff;
            line-height: 1.2;
        }
        
        .loading-spinner {
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255,255,255,0.3);
            border-top-color: var(--primary-red);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .content-section {
            padding: 15px 10px;
            max-width: 1400px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
            background: var(--dark-bg);
        }
        
        .video-info {
            text-align: center;
            margin-bottom: 15px;
            padding: 10px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
        }
        
        .video-title {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 8px;
            color: #fff;
        }
        
        .video-badges {
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .badge-red {
            background: var(--primary-red);
            color: white;
        }
        
        .badge-blue {
            background: var(--primary-blue);
            color: white;
        }
        
        .badge-green {
            background: #28a745;
            color: white;
        }
        
        .donation-card {
            background: rgba(255, 193, 7, 0.1);
            border: 1px solid rgba(255, 193, 7, 0.2);
            border-radius: 15px;
            padding: 25px;
            margin: 30px 0 10px;
            text-align: center;
        }
        
        .donation-qr {
            width: 180px;
            height: 180px;
            border-radius: 10px;
            margin: 0 auto 15px;
            border: 2px solid rgba(255, 193, 7, 0.3);
            background: white;
            padding: 10px;
        }
        
        .toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 12px 25px;
            border-radius: 10px;
            z-index: 10000;
            font-size: 0.9rem;
            display: none;
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
            border: 1px solid rgba(255,0,0,0.3);
            backdrop-filter: blur(10px);
        }
        
        .toast.show {
            display: block;
            animation: slideUp 0.3s ease;
        }
        
        .toast-error {
            border-color: #ff4444;
            background: rgba(0, 0, 0, 0.95);
        }
        
        .toast-warning {
            border-color: #ffaa00;
            background: rgba(0, 0, 0, 0.95);
        }
        
        .toast-success {
            border-color: #00ff00;
            background: rgba(0, 0, 0, 0.95);
        }
        
        @keyframes slideUp {
            from { transform: translate(-50%, 100%); opacity: 0; }
            to { transform: translate(-50%, 0%); opacity: 1; }
        }
        
        @keyframes fadeInOut {
            0% { opacity: 0; transform: translateY(-50%) scale(0.8); }
            20% { opacity: 1; transform: translateY(-50%) scale(1); }
            80% { opacity: 1; transform: translateY(-50%) scale(1); }
            100% { opacity: 0; transform: translateY(-50%) scale(0.8); }
        }
        
        /* External player dialog with ads */
        .external-player-dialog {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            border: 2px solid var(--accent);
            border-radius: 20px;
            padding: 20px;
            z-index: 10001;
            width: 95%;
            max-width: 380px;
            text-align: center;
            box-shadow: 0 10px 40px rgba(0,0,0,0.8);
            display: none;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .external-player-dialog.show {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        .dialog-ad-container {
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            overflow: hidden;
            min-height: 60px;
            position: relative;
            margin-top: 15px;
        }
        
        .dialog-ad-container.loading::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            animation: loading 1.5s infinite;
            pointer-events: none;
        }
        
        @keyframes loading {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        .dialog-ad-container iframe {
            max-width: 100%;
            border-radius: 8px;
            border: none;
            background: white;
        }
        
        .dialog-title {
            font-size: 1.3rem;
            color: var(--accent);
            margin: 10px 0;
            font-weight: bold;
        }
        
        .dialog-message {
            color: #fff;
            margin-bottom: 15px;
            font-size: 1rem;
            background: rgba(255,255,255,0.1);
            padding: 10px;
            border-radius: 10px;
        }
        
        .dialog-buttons {
            display: flex;
            gap: 8px;
            justify-content: center;
            flex-wrap: wrap;
            margin: 10px 0;
        }
        
        .dialog-btn {
            padding: 12px 15px;
            border: none;
            border-radius: 10px;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            flex: 1;
            min-width: 110px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }
        
        .btn-primary {
            background: linear-gradient(45deg, var(--primary-red), var(--primary-blue));
            color: white;
        }
        
        .btn-secondary {
            background: rgba(255,255,255,0.1);
            color: white;
            border: 1px solid rgba(255,255,255,0.3);
        }
        
        .btn-primary:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(255,0,0,0.4);
        }
        
        .btn-secondary:hover {
            background: rgba(255,255,255,0.2);
        }
        
        .dialog-close {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255,255,255,0.1);
            border: none;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.3s ease;
        }
        
        .dialog-close:hover {
            background: rgba(255,255,255,0.2);
            transform: rotate(90deg);
        }
        
        .dialog-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            margin-right: 8px;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translate(-50%, -60%); }
            to { opacity: 1; transform: translate(-50%, -50%); }
        }
        
        /* Mobile Optimizations */
        @media (max-width: 768px) {
            .main-container {
                min-height: calc(100vh - 60px);
            }
            
            .video-controls {
                padding: 10px;
                gap: 8px;
            }
            
            .control-btn {
                width: 36px;
                height: 36px;
                font-size: 1rem;
            }
            
            .play-pause-btn {
                width: 40px;
                height: 40px;
            }
            
            .time-display {
                font-size: 0.8rem;
                min-width: 85px;
            }
            
            .play-overlay {
                width: 60px;
                height: 60px;
                font-size: 1.5rem;
            }
            
            .channels-grid {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
                gap: 8px;
            }
            
            .channel-logo {
                width: 70px;
                height: 70px;
            }
            
            .channel-name {
                font-size: 0.7rem;
            }
            
            .external-player-dialog {
                width: 98%;
                padding: 15px;
                max-height: 95vh;
            }
            
            .dialog-btn {
                padding: 10px 12px;
                font-size: 0.9rem;
                min-width: 90px;
            }
            
            .dialog-title {
                font-size: 1.2rem;
            }
            
            .dialog-message {
                font-size: 0.9rem;
                padding: 8px;
            }
        }
        
        @media (max-width: 480px) {
            .channels-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .video-controls {
                padding: 8px;
                gap: 6px;
            }
            
            .control-btn {
                width: 32px;
                height: 32px;
                font-size: 0.9rem;
            }
            
            .play-pause-btn {
                width: 36px;
                height: 36px;
            }
            
            .time-display {
                font-size: 0.75rem;
                min-width: 75px;
            }
        }
        
        /* Hide controls when not interacting */
        .video-container.controls-hidden .video-controls {
            opacity: 0;
            transform: translateY(100%);
        }
        
        .video-container:hover .video-controls,
        .video-container.touch-active .video-controls {
            opacity: 1;
            transform: translateY(0);
        }
    </style>
</head>

<body>
    <!-- Navigation -->
    <nav class="top-navbar">
        <div class="container-fluid">
            <div class="navbar-content">
                <div class="logo-section">
                    <a href="#" style="display: flex; align-items: center; color: white; text-decoration: none;">
                        <img src="https://iili.io/KOlfc41.png" alt="SK4FiLM Logo" class="logo-img">
                        <div class="brand-content">
                            <div class="brand-text">SK4FiLM</div>
                            <div class="brand-subtitle">House of Entertainment</div>
                        </div>
                    </a>
                </div>
                
                <div class="action-buttons">
                    <button class="search-icon-btn" onclick="toggleSearch()" id="searchToggleBtn" title="Search">
                        <i class="fas fa-search"></i>
                    </button>
                    
                    <div class="menu-section">
                        <button class="menu-button" onclick="toggleMenu()" id="menuToggleBtn">
                            <div class="menu-lines">
                                <div class="menu-line"></div>
                                <div class="menu-line"></div>
                                <div class="menu-line"></div>
                            </div>
                        </button>
                        
                        <div class="menu-dropdown" id="menuDropdown">
                            <h4><i class="fas fa-share-alt me-2"></i>Follow Us</h4>
                            <div class="menu-links">
                                <a href="https://t.me/sk4film" target="_blank" class="menu-link">
                                    <i class="fab fa-telegram" style="color: #0088cc;"></i>
                                    <span>Telegram</span>
                                </a>
                                <a href="https://whatsapp.com/channel/0029Vb7IRSF89inj7Za3cQ0Y" target="_blank" class="menu-link">
                                    <i class="fab fa-whatsapp" style="color: #25d366;"></i>
                                    <span>WhatsApp</span>
                                </a>
                                <a href="https://youtube.com/@Skcreator7" target="_blank" class="menu-link">
                                    <i class="fab fa-youtube" style="color: #ff0000;"></i>
                                    <span>YouTube</span>
                                </a>
                                <a href="https://t.me/skfilmbot" target="_blank" class="menu-link">
                                    <i class="fas fa-robot" style="color: #7b68ee;"></i>
                                    <span>Telegram Bot</span>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>
    
    <!-- Search Container -->
    <div class="search-container" id="searchContainer">
        <div class="search-wrapper">
            <input 
                type="text" 
                class="inline-search-input" 
                id="inlineSearchInput" 
                placeholder="Search channels..."
                onkeypress="if(event.key==='Enter') doInlineSearch()"
            >
            <button class="inline-search-btn" onclick="doInlineSearch()">
                <i class="fas fa-arrow-right"></i>
            </button>
        </div>
    </div>
    
    <!-- External Player Dialog with Ads - Only Bottom Ad -->
    <div class="external-player-dialog" id="externalPlayerDialog">
        <div class="dialog-title" id="dialogTitle">Open in External Player</div>
        <div class="dialog-message" id="dialogMessage">Choose a player to open this stream</div>
        
        <div class="dialog-buttons">
            <button class="dialog-btn btn-primary" id="dialogVLCBtn" onclick="openWithVLC()">
                <i class="fab fa-vlc me-2"></i>VLC
            </button>
            <button class="dialog-btn btn-primary" id="dialogMXBtn" onclick="openWithMX()">
                <i class="fas fa-play me-2"></i>MX Player
            </button>
        </div>
        
        <!-- Install buttons -->
        <div class="dialog-buttons" style="margin-top: 10px;" id="installButtonsContainer">
            <button class="dialog-btn btn-secondary" id="dialogPlayStoreVLC" onclick="openPlayStore('vlc')" style="display: none;">
                <i class="fab fa-google-play me-2"></i>Install VLC
            </button>
            <button class="dialog-btn btn-secondary" id="dialogPlayStoreMX" onclick="openPlayStore('mx')" style="display: none;">
                <i class="fab fa-google-play me-2"></i>Install MX
            </button>
        </div>
        
        <!-- Your Custom Ad Script - Only Bottom -->
        <div class="dialog-ad-container">
            <script>
            (function(ky){
            var d = document,
                s = d.createElement('script'),
                l = d.scripts[d.scripts.length - 1];
            s.settings = ky || {};
            s.src = "\/\/illiterate-being.com\/bbX.VusIdeGalL0BYWWOcv\/yeEmj9gu\/ZHUVlVk\/PGT\/Y\/4BMeDKcs4ZOLT\/cBt_NXjYgOwtNozIkbwfMWQs";
            s.async = true;
            s.referrerPolicy = 'no-referrer-when-downgrade';
            l.parentNode.insertBefore(s, l);
            })({})
            </script>
        </div>
        
        <!-- Close Button -->
        <button class="dialog-close" onclick="closeExternalDialog()" title="Close">
            <i class="fas fa-times"></i>
        </button>
    </div>
    
    <div class="container-fluid px-0">
        <!-- Top Ads - Now directly below navbar -->
        <div class="ad-container">
            <div class="ad-desktop">
                <script type="text/javascript">
                    atOptions = {
                        'key' : '3118cf3c0d1d908e59d96fac6de40e1f',
                        'format' : 'iframe',
                        'height' : 90,
                        'width' : 728,
                        'params' : {}
                    };
                </script>
                <script type="text/javascript" src="//marksdespitelinear.com/3118cf3c0d1d908e59d96fac6de40e1f/invoke.js"></script>
            </div>
            <div class="ad-mobile">
                <script type="text/javascript">
                    atOptions = {
                        'key' : 'c628de75b51e4c70d2f3bebebbaaf335',
                        'format' : 'iframe',
                        'height' : 50,
                        'width' : 320,
                        'params' : {}
                    };
                </script>
                <script type="text/javascript" src="//marksdespitelinear.com/c628de75b51e4c70d2f3bebebbaaf335/invoke.js"></script>
            </div>
        </div>

        <!-- Main Container -->
        <div class="main-container">
            <!-- Video Wrapper -->
            <div class="video-wrapper">
                <div class="aspect-ratio-box">
                    <div class="video-container" id="videoContainer">
                        
                        <!-- Fullscreen Gesture Indicators -->
                        <div class="gesture-indicator brightness-indicator" id="brightnessIndicator">
                            <i class="fas fa-sun"></i>
                            <div class="gesture-value" id="brightnessValue">100%</div>
                        </div>
                        
                        <div class="gesture-indicator volume-indicator" id="volumeIndicator">
                            <i class="fas fa-volume-up"></i>
                            <div class="gesture-value" id="volumeValue">100%</div>
                        </div>
                        
                        <!-- Side Click Areas -->
                        <div class="side-click-area left-click-area" onclick="toggleControls()"></div>
                        <div class="side-click-area right-click-area" onclick="toggleControls()"></div>
                        
                        <!-- Shaka Player Video Element -->
                        <video 
                            id="video-element"
                            class="shaka-video" 
                            autoplay
                            playsinline
                            crossorigin="anonymous"
                            poster="https://i.ibb.co/My6p4wTm/file-0000000009c87206b22a94177df5dabd.png">
                        </video>
                        
                        <!-- Play Overlay -->
                        <div class="play-overlay" id="playOverlay" onclick="togglePlay()">
                            <i class="fas fa-play"></i>
                        </div>
                        
                        <!-- Custom Video Controls -->
                        <div class="video-controls" id="videoControls">
                            <button class="control-btn play-pause-btn" onclick="togglePlay()" id="playBtn">
                                <i class="fas fa-play" id="playIcon"></i>
                            </button>
                            
                            <div class="time-display">
                                <span id="currentTime">0:00</span> / <span id="duration">0:00</span>
                            </div>
                            
                            <div class="progress-container" id="progressContainer" 
                                 onmousedown="startSeeking(event)"
                                 onmousemove="handleSeeking(event)"
                                 onmouseup="stopSeeking()"
                                 onmouseleave="stopSeeking()"
                                 ontouchstart="startSeeking(event)"
                                 ontouchmove="handleSeeking(event)"
                                 ontouchend="stopSeeking()">
                                <div class="buffer-bar" id="bufferBar"></div>
                                <div class="progress-bar" id="progressBar"></div>
                                <div class="progress-thumb" id="progressThumb"></div>
                            </div>
                            
                            <button class="control-btn fullscreen-btn" onclick="toggleFullscreen()">
                                <i class="fas fa-expand"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Content Section -->
            <div class="content-section">
                <!-- Video Info -->
                <div class="video-info">
                    <div class="video-title" id="videoTitle">SK4FiLM Live Stream</div>
                    <div class="video-badges">
                        <span class="badge badge-red">
                            <i class="fas fa-file me-1"></i> Live Stream
                        </span>
                        <span class="badge badge-blue">
                            <i class="fas fa-wifi me-1"></i> Direct HLS
                        </span>
                        <span class="badge badge-green">
                            <i class="fas fa-tachometer-alt me-1"></i> Fast
                        </span>
                    </div>
                </div>

                <!-- Ad 1 - After Video Info -->
                <div class="ad-container" style="margin: 10px 0;">
                    <script type="text/javascript">
                        atOptions = {
                            'key' : '567936a964b0784aedd11f237d26bee0',
                            'format' : 'iframe',
                            'height' : 250,
                            'width' : 300,
                            'params' : {}
                        };
                    </script>
                    <script>
(function(reha){
var d = document,
    s = d.createElement('script'),
    l = d.scripts[d.scripts.length - 1];
s.settings = reha || {};
s.src = "\/\/illiterate-being.com\/boXEVhsnd.GqlF0fYrW\/cd\/PeKmX9XuRZUUplvkAPCTTYJ4\/MHTaE\/3BNBDUExtlNkjlg\/xbMdT-cG0-N\/Qe";
s.async = true;
s.referrerPolicy = 'no-referrer-when-downgrade';
l.parentNode.insertBefore(s, l);
})({})
</script>
                </div>

                <!-- Sports Category -->
                <div class="category-section">
                    <div class="category-title">
                        <i class="fas fa-futbol me-2" style="color: var(--primary-red);"></i> Sports Channels
                    </div>
                    <div class="channels-grid" id="sports-channels">
                        <!-- Sports channels will be loaded here by JavaScript -->
                    </div>
                </div>

                <!-- Ad 2 - After Sports -->
                <div class="ad-container" style="margin: 10px 0;">
                    <script type="text/javascript">
                        atOptions = {
                            'key' : '567936a964b0784aedd11f237d26bee0',
                            'format' : 'iframe',
                            'height' : 250,
                            'width' : 300,
                            'params' : {}
                        };
                    </script>
                    <script type="text/javascript" src="//marksdespitelinear.com/567936a964b0784aedd11f237d26bee0/invoke.js"></script>
                </div>

                <!-- Movies Category -->
                <div class="category-section">
                    <div class="category-title">
                        <i class="fas fa-film me-2" style="color: var(--primary-blue);"></i> Movies Channels
                    </div>
                    <div class="channels-grid" id="movies-channels">
                        <!-- Movies channels will be loaded here by JavaScript -->
                    </div>
                </div>

                <!-- Ad 3 - After Movies -->
                <div class="ad-container" style="margin: 10px 0;">
                    <script type="text/javascript">
                        atOptions = {
                            'key' : '567936a964b0784aedd11f237d26bee0',
                            'format' : 'iframe',
                            'height' : 250,
                            'width' : 300,
                            'params' : {}
                        };
                    </script>
                    <script>
(function(hxnsvbj){
var d = document,
    s = d.createElement('script'),
    l = d.scripts[d.scripts.length - 1];
s.settings = hxnsvbj || {};
s.src = "\/\/illiterate-being.com\/bUX.VisrdCGQlh0-YOWUcX\/depmJ9LuEZhUWlDkEPPTxYI3KN\/jKIWxHM\/jAkXtcNsjkc\/2IMIjNEczQMDAb";
s.async = true;
s.referrerPolicy = 'no-referrer-when-downgrade';
l.parentNode.insertBefore(s, l);
})({})
</script>
                </div>

                <!-- Music Category -->
                <div class="category-section">
                    <div class="category-title">
                        <i class="fas fa-music me-2" style="color: #ff6b6b;"></i> Music Channels
                    </div>
                    <div class="channels-grid" id="music-channels">
                        <!-- Music channels will be loaded here by JavaScript -->
                    </div>
                    <div class="text-center mt-3" style="color: #aaa; font-size: 0.9rem;">
                        <i class="fas fa-plus-circle me-1"></i> More channels adding soon...
                    </div>
                </div>

                <!-- Donation Section -->
                <div class="donation-card">
                    <h4 class="text-warning mb-3">
                        <i class="fas fa-heart me-2"></i> Support SK4FiLM
                    </h4>
                    <p class="mb-3">Help us maintain this streaming service and add more features.</p>
                    
                    <img src="https://i.ibb.co/60HWrpFt/file-0000000034d472078cea683cd0ecbae0.png" 
                         alt="Donation QR Code" 
                         class="donation-qr">
                    
                    <div class="mb-3">
                        <h6 class="text-light">UPI ID:</h6>
                        <div class="input-group mx-auto" style="max-width: 300px;">
                            <input type="text" class="form-control bg-dark text-light text-center" 
                                   value="cf.sk4film@cashfreensdlpb" readonly id="upiId">
                            <button class="btn btn-warning" onclick="copyUPI()">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                    </div>
                    
                    <a href="https://cfpe.me/skfilmbox" target="_blank" class="btn btn-warning px-4">
                        <i class="fas fa-donate me-2"></i> DONATE NOW
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>

    <script>
        // Initialize WOW.js
        if (typeof WOW !== 'undefined') {
            new WOW().init();
        }
        
        // Global Variables
        let player = null; // Shaka Player instance
        let videoElement = null;
        let isPlaying = true;
        let controlsTimeout = null;
        let controlsVisible = false;
        let isSeeking = false;
        let seekStartX = 0;
        let isFullscreen = false;
        let currentVolume = 1.0;
        let currentChannelUrl = '';
        let currentChannelName = '';
        let backupUrl = '';
        
        // CORS Proxy to fix mixed content and CORS issues
        const CORS_PROXY = 'https://cors-anywhere.herokuapp.com/';
        
        // Channel logos mapping
        const channelLogos = {
            // Sports
            'star sports Hd': 'https://i.ibb.co/ywrgTyZ/star-sports-live-cricket-matches-guide-screenshot.png',
            'star sports 1 hindi': 'https://i.ibb.co/4RFSmjvK/IMG-20260220-190309.png',
            'star sports 2 hindi': 'https://i.ibb.co/r2cVyTRr/images-1.jpg',
            'Sony Sports HD': 'https://i.ibb.co/8WvRk5k/images-2.jpg',
            'Sony Sports 2': 'https://i.ibb.co/qYSpYPw4/1390.webp',
            'Sony Sports 3': 'https://i.ibb.co/Qv8XHQqf/Ten3-HD.png',
            // Movies
            'Sony Max': 'https://i.ibb.co/q3CLCXFY/Sony-Max-new-logo.png',
            'Sony Pix HD': 'https://i.ibb.co/L3SFy2D/214x0-icon.png',
            'Sony Wah': 'https://i.ibb.co/d0cgFwKt/images-3.jpg',
            '&pictures HD': 'https://i.ibb.co/MDvPcjq2/And-Pictures-HD.png',
            'Colors Cineplex': 'https://i.ibb.co/TMXmZqKm/images-4.jpg',
            'Zee Action': 'https://i.ibb.co/R42DsF0H/zee-action-advertising-services-500x500.png',
            'Box Cinema': 'https://upload.wikimedia.org/wikipedia/commons/8/8e/Box_Cinema_logo.png',
            'B4U Movies': 'https://upload.wikimedia.org/wikipedia/commons/9/92/B4U_Network_logo.png',
            'Dhamaka Movies B4U': 'https://upload.wikimedia.org/wikipedia/commons/9/92/B4U_Network_logo.png',
            // Music
            '9xM': 'https://upload.wikimedia.org/wikipedia/commons/5/5c/9XM_Logo.png',
            'Mastiii': 'https://upload.wikimedia.org/wikipedia/commons/4/49/Mastiii_logo.png',
            'B4U Music': 'https://upload.wikimedia.org/wikipedia/commons/9/92/B4U_Network_logo.png'
        };

        // Channel data
        const channels = {
            sports: [
                { name: 'star sports Hd', url: 'http://103.229.254.25:7001/play/a0a0/index.m3u8' },
                { name: 'star sports 1 hindi', url: 'http://161.248.38.40:8000/play/a071/index.m3u8' },
                { name: 'star sports 2 hindi', url: 'http://161.248.38.40:8000/play/a06n/index.m3u8' },
                { name: 'Sony Sports HD', url: 'http://103.229.254.25:7001/play/a02t/index.m3u8' },
                { name: 'Sony Sports 2', url: 'http://103.229.254.25:7001/play/a09q/index.m3u8' },
                { name: 'Sony Sports 3', url: 'http://103.229.254.25:7001/play/a0dw/index.m3u8' }
            ],
            movies: [
                { name: 'Sony Max', url: 'https://streamer2.nexgen.bz/SONYMAX/index.m3u8' },
                { name: 'Sony Pix HD', url: 'http://103.229.254.25:7001/play/a0ed/index.m3u8' },
                { name: 'Sony Wah', url: 'http://103.78.149.54:8000/play/a01p/index.m3u8' },
                { name: '&pictures HD', url: 'http://103.229.254.25:7001/play/a033/index.m3u8' },
                { name: 'Colors Cineplex', url: 'http://103.182.170.32:8888/play/a01o' },
                { name: 'Zee Action', url: 'http://103.78.149.54:8000/play/a005/index.m3u8' },
                { name: 'Box Cinema', url: 'https://d3s7x6kmqcnb6b.cloudfront.net/d/distro001a/QK2TKFREGRYXDI8IJGHW/hls3/now,-1m/m.m3u8?ads.vf=kU8ru-Yl4zG' },
                { name: 'B4U Movies', url: 'https://amg00877-b4unew-amg00877c2-lg-in-5260.playouts.now.amagi.tv/playlist.m3u8' },
                { name: 'Dhamaka Movies B4U', url: 'https://cdn-1.pishow.tv/live/235/master.m3u8' }
            ],
            music: [
                { name: '9xM', url: 'https://b.jsrdn.com/strm/channels/9xm/master.m3u8' },
                { name: 'Mastiii', url: 'https://mumt02.tangotv.in/MASTIII/index.m3u8' },
                { name: 'B4U Music', url: 'https://cdnb4u.wiseplayout.com/B4U_Music/master.m3u8' }
            ]
        };

        // Working backup streams (in case main streams fail)
        const backupStreams = {
            'star sports Hd': 'https://cdn-2.pishow.tv/live/1461/master.m3u8',
            'Sony Sports HD': 'https://cdn-2.pishow.tv/live/1461/master.m3u8',
            'Sony Max': 'https://cdn-2.pishow.tv/live/1461/master.m3u8',
            '9xM': 'https://cdn-2.pishow.tv/live/1461/master.m3u8'
        };

        // Initialize on DOM Load
        document.addEventListener('DOMContentLoaded', async () => {
            console.log(" SK4FiLM Player Initializing with Shaka Player...");
            
            fixIOSScrolling();
            await initializeShakaPlayer();
            loadChannels();
            setupControls();
            setupFullscreenDetection();
            
            console.log(" Player Ready!");
        });

        // Initialize Shaka Player
        async function initializeShakaPlayer() {
            videoElement = document.getElementById('video-element');
            
            // Install built-in polyfills to support HLS and other formats
            shaka.polyfill.installAll();
            
            // Check if the browser supports the basic APIs
            if (shaka.Player.isBrowserSupported()) {
                // Create a Player instance
                player = new shaka.Player(videoElement);
                
                // Attach event listeners
                player.addEventListener('error', onShakaError);
                player.addEventListener('buffering', onShakaBuffering);
                
                // Configure player for better HLS support
                player.configure({
                    streaming: {
                        bufferingGoal: 30,
                        rebufferingGoal: 15,
                        bufferBehind: 30,
                        ignoreTextStreamFailures: true,
                        alwaysStreamText: false,
                        startAtSegmentBoundary: false,
                        accurateManifestUpdate: true,
                        smallGapLimit: 0.5,
                        jumpLargeGaps: true,
                        durationBackoff: 1,
                        retryParameters: {
                            maxAttempts: 5,
                            baseDelay: 1000,
                            backoffFactor: 2,
                            fuzzFactor: 0.5,
                            timeout: 30000
                        },
                        updateIntervalSeconds: 1,
                        dispatchAllEmsgBoxes: true
                    },
                    manifest: {
                        dash: {
                            ignoreMinBufferTime: true
                        },
                        hls: {
                            ignoreManifestProgramDateTime: false,
                            ignoreTextStreamFailures: true,
                            defaultAudioCodec: 'mp4a.40.2',
                            defaultVideoCodec: 'avc1.42E01E'
                        }
                    },
                    drm: {
                        retryParameters: {
                            maxAttempts: 3,
                            baseDelay: 500,
                            backoffFactor: 2,
                            fuzzFactor: 0.5,
                            timeout: 10000
                        }
                    }
                });
                
                // Set up media element event listeners
                videoElement.addEventListener('play', onVideoPlaying);
                videoElement.addEventListener('pause', onVideoPaused);
                videoElement.addEventListener('timeupdate', updateProgress);
                videoElement.addEventListener('loadedmetadata', updateDurationDisplay);
                videoElement.addEventListener('progress', updateBuffer);
                videoElement.addEventListener('volumechange', () => {
                    currentVolume = videoElement.volume;
                });
                videoElement.addEventListener('waiting', () => {
                    showToast('Buffering...', 2000);
                });
                
                // Set initial volume
                videoElement.volume = currentVolume;
                
                // Try to play the default stream
                tryInternalPlayer('https://cdn-2.pishow.tv/live/1461/master.m3u8', 'SK4FiLM Live');
            } else {
                console.error('Browser not supported!');
                showToast('Your browser does not support Shaka Player', 5000, 'error');
            }
        }

        function onShakaError(event) {
            console.error('Shaka Player error:', event.detail);
            
            // Try HTTPS version if current URL is HTTP
            if (currentChannelUrl && currentChannelUrl.startsWith('http://') && !currentChannelUrl.includes('https')) {
                showToast("Trying secure connection...", 2000);
                let httpsUrl = 'https://' + currentChannelUrl.substring(7);
                tryInternalPlayer(httpsUrl, currentChannelName);
            }
            // Show external player options
            else if (currentChannelName && currentChannelUrl) {
                showExternalPlayerDialog(currentChannelName, currentChannelUrl);
            } else {
                showToast('Stream not available. Try another channel.', 4000, 'error');
            }
        }

        function onShakaBuffering(event) {
            if (event.buffering) {
                showToast('Buffering...', 2000);
            }
        }

        function loadChannels() {
            // Load Sports Channels
            const sportsGrid = document.getElementById('sports-channels');
            channels.sports.forEach(channel => {
                sportsGrid.appendChild(createChannelCard(channel.name, channel.url, 'sports'));
            });

            // Load Movies Channels
            const moviesGrid = document.getElementById('movies-channels');
            channels.movies.forEach(channel => {
                moviesGrid.appendChild(createChannelCard(channel.name, channel.url, 'movies'));
            });

            // Load Music Channels
            const musicGrid = document.getElementById('music-channels');
            channels.music.forEach(channel => {
                musicGrid.appendChild(createChannelCard(channel.name, channel.url, 'music'));
            });
        }

        function createChannelCard(name, url, category) {
            const card = document.createElement('div');
            card.className = 'channel-card';
            card.onclick = () => playChannel(name, url);
            
            const logo = document.createElement('img');
            logo.className = 'channel-logo';
            logo.src = channelLogos[name] || '';
            logo.alt = name;
            logo.onerror = function() {
                this.style.display = 'none';
                const initialSpan = document.createElement('span');
                initialSpan.style.width = '80px';
                initialSpan.style.height = '80px';
                initialSpan.style.borderRadius = '50%';
                initialSpan.style.background = 'linear-gradient(135deg, var(--primary-red), var(--primary-blue))';
                initialSpan.style.display = 'flex';
                initialSpan.style.alignItems = 'center';
                initialSpan.style.justifyContent = 'center';
                initialSpan.style.fontSize = '2rem';
                initialSpan.style.fontWeight = 'bold';
                initialSpan.style.color = 'white';
                initialSpan.style.marginBottom = '8px';
                initialSpan.textContent = name.charAt(0).toUpperCase();
                card.insertBefore(initialSpan, card.firstChild);
            };
            
            const nameEl = document.createElement('div');
            nameEl.className = 'channel-name';
            nameEl.textContent = name;
            
            card.appendChild(logo);
            card.appendChild(nameEl);
            
            return card;
        }

        // Smart Play Function - Tries internal player first, then external
        async function playChannel(name, url) {
            console.log(`Playing: ${name} - ${url}`);
            
            currentChannelName = name;
            currentChannelUrl = url;
            backupUrl = backupStreams[name] || '';
            
            // Update video title
            document.getElementById('videoTitle').textContent = name;
            
            // Show loading state
            showToast(`Loading ${name}...`, 2000);
            
            // Try internal player first
            tryInternalPlayer(url, name);
        }
        
        async function tryInternalPlayer(url, name, useHttps = false) {
            let streamUrl = url;
            
            // Try HTTPS if specified and URL is HTTP
            if (useHttps && streamUrl.startsWith('http://')) {
                streamUrl = 'https://' + streamUrl.substring(7);
                console.log("Trying HTTPS version:", streamUrl);
            }
            
            try {
                // Load the stream with Shaka Player
                await player.load(streamUrl);
                
                // Start playback
                videoElement.play();
                
                console.log("Internal player playing successfully");
            } catch (error) {
                console.error('Playback error:', error);
                
                // Try HTTPS version if original was HTTP and haven't tried yet
                if (!useHttps && url.startsWith('http://')) {
                    showToast("Trying secure connection...", 2000);
                    tryInternalPlayer(url, name, true);
                }
                // Try backup if available
                else if (backupUrl) {
                    showToast("Trying backup stream...", 2000);
                    tryInternalPlayer(backupUrl, name);
                } else {
                    // Show external player options
                    showExternalPlayerDialog(name, url);
                }
            }
        }
        
        function showExternalPlayerDialog(name, url) {
            currentChannelUrl = url;
            currentChannelName = name;
            
            const dialog = document.getElementById('externalPlayerDialog');
            const title = document.getElementById('dialogTitle');
            const message = document.getElementById('dialogMessage');
            const vlcBtn = document.getElementById('dialogVLCBtn');
            const mxBtn = document.getElementById('dialogMXBtn');
            const installVLC = document.getElementById('dialogPlayStoreVLC');
            const installMX = document.getElementById('dialogPlayStoreMX');
            
            title.textContent = ` Play "${name}"`;
            message.innerHTML = ` Internal player failed.<br> Open in external player?<br><small style="color: #ffaa00;"> Ads help us keep this free!</small>`;
            
            // Show main buttons
            vlcBtn.style.display = 'flex';
            mxBtn.style.display = 'flex';
            installVLC.style.display = 'none';
            installMX.style.display = 'none';
            
            // Reload bottom ad only
            reloadBottomAd();
            
            dialog.classList.add('show');
        }
        
        function showInstallDialog(app) {
            const dialog = document.getElementById('externalPlayerDialog');
            const title = document.getElementById('dialogTitle');
            const message = document.getElementById('dialogMessage');
            const vlcBtn = document.getElementById('dialogVLCBtn');
            const mxBtn = document.getElementById('dialogMXBtn');
            const installVLC = document.getElementById('dialogPlayStoreVLC');
            const installMX = document.getElementById('dialogPlayStoreMX');
            
            title.textContent = ` ${app.toUpperCase()} Player Not Found`;
            message.innerHTML = ` Install ${app.toUpperCase()} player from Play Store?<br><small style="color: #ffaa00;"> Free download  Supports us</small>`;
            
            vlcBtn.style.display = 'none';
            mxBtn.style.display = 'none';
            
            if (app === 'vlc') {
                installVLC.style.display = 'flex';
                installMX.style.display = 'none';
            } else {
                installVLC.style.display = 'none';
                installMX.style.display = 'flex';
            }
            
            // Keep bottom ad visible
            reloadBottomAd();
            
            dialog.classList.add('show');
        }
        
        function reloadBottomAd() {
            // Get only the bottom ad container (last child of dialog-ad-container)
            const bottomAdContainer = document.querySelector('#externalPlayerDialog .dialog-ad-container:last-child');
            
            if (bottomAdContainer) {
                // Clear container
                bottomAdContainer.innerHTML = '';
                bottomAdContainer.classList.add('loading');
                
                // Create new script element with your ad code
                const script = document.createElement('script');
                script.innerHTML = `
                (function(ky){
                var d = document,
                    s = d.createElement('script'),
                    l = d.scripts[d.scripts.length - 1];
                s.settings = ky || {};
                s.src = "\\/\\/illiterate-being.com\\/bbX.VusIdeGalL0BYWWOcv\\/yeEmj9gu\\/ZHUVlVk\\/PGT\\/Y\\/4BMeDKcs4ZOLT\\/cBt_NXjYgOwtNozIkbwfMWQs";
                s.async = true;
                s.referrerPolicy = 'no-referrer-when-downgrade';
                l.parentNode.insertBefore(s, l);
                })({})
                `;
                bottomAdContainer.appendChild(script);
                
                // Remove loading class after ad loads
                setTimeout(() => {
                    bottomAdContainer.classList.remove('loading');
                }, 500);
            }
        }
        
        function closeExternalDialog() {
            const dialog = document.getElementById('externalPlayerDialog');
            dialog.classList.remove('show');
            
            // Clear bottom ad when closing to save resources
            setTimeout(() => {
                if (!dialog.classList.contains('show')) {
                    const bottomAdContainer = document.querySelector('#externalPlayerDialog .dialog-ad-container:last-child');
                    if (bottomAdContainer) {
                        bottomAdContainer.innerHTML = ''; // Clear ad when dialog is hidden
                    }
                }
            }, 500);
        }
        
        // Fixed function to open in VLC with proper URL handling
        function openWithVLC() {
            showToast("Opening in VLC...", 2000);
            closeExternalDialog();
            
            let streamUrl = currentChannelUrl;
            
            // Ensure URL is properly encoded for intent
            const encodedUrl = encodeURIComponent(streamUrl);
            
            // For Android - Using multiple methods
            if (/Android/i.test(navigator.userAgent)) {
                // Method 1: Direct intent for VLC (most reliable)
                const vlcIntent = `intent:${streamUrl}#Intent;package=org.videolan.vlc;action=android.intent.action.VIEW;type=video/*;end`;
                
                // Method 2: VLC custom scheme
                const vlcScheme = `vlc://${streamUrl}`;
                
                // Method 3: HTTP intent
                const httpIntent = `intent:${streamUrl}#Intent;package=org.videolan.vlc;action=android.intent.action.VIEW;end`;
                
                // Try all methods in sequence with small delays
                try {
                    // Try intent first
                    window.location.href = vlcIntent;
                    
                    // After a short delay, try scheme if still here
                    setTimeout(() => {
                        try {
                            window.location.href = vlcScheme;
                        } catch(e) {}
                    }, 300);
                    
                    // After another delay, try http intent
                    setTimeout(() => {
                        try {
                            window.location.href = httpIntent;
                        } catch(e) {}
                    }, 600);
                    
                } catch(e) {
                    console.error("Error opening VLC:", e);
                }
                
                // Check if VLC opened (if not, show install dialog)
                setTimeout(() => {
                    if (document.visibilityState === 'visible') {
                        // Page is still visible, app probably not opened
                        showInstallDialog('vlc');
                    }
                }, 1500);
            } 
            // For iOS
            else if (/iPhone|iPad|iPod/i.test(navigator.userAgent)) {
                // Try VLC for iOS URL scheme
                const iosVlcUrl = `vlc-x-callback://x-callback-url/stream?url=${encodedUrl}`;
                const iosVlcUrl2 = `vlc://${encodedUrl}`;
                
                try {
                    window.location.href = iosVlcUrl;
                    
                    setTimeout(() => {
                        try {
                            window.location.href = iosVlcUrl2;
                        } catch(e) {}
                    }, 300);
                } catch(e) {}
                
                setTimeout(() => {
                    if (document.visibilityState === 'visible') {
                        showInstallDialog('vlc');
                    }
                }, 1500);
            }
            // For desktop - open in new tab
            else {
                window.open(streamUrl, '_blank');
            }
        }
        
        // Fixed function to open in MX Player with proper URL handling
        function openWithMX() {
            showToast("Opening in MX Player...", 2000);
            closeExternalDialog();
            
            let streamUrl = currentChannelUrl;
            
            // MX Player only works on Android
            if (/Android/i.test(navigator.userAgent)) {
                // Method 1: Direct intent for MX Player
                const mxIntent = `intent:${streamUrl}#Intent;package=com.mxtech.videoplayer.ad;action=android.intent.action.VIEW;type=video/*;end`;
                
                // Method 2: MX Player custom scheme
                const mxScheme = `mxplayer://${streamUrl}`;
                
                // Method 3: HTTP intent
                const mxHttpIntent = `intent:${streamUrl}#Intent;package=com.mxtech.videoplayer.ad;action=android.intent.action.VIEW;end`;
                
                try {
                    // Try intent first
                    window.location.href = mxIntent;
                    
                    setTimeout(() => {
                        try {
                            window.location.href = mxScheme;
                        } catch(e) {}
                    }, 300);
                    
                    setTimeout(() => {
                        try {
                            window.location.href = mxHttpIntent;
                        } catch(e) {}
                    }, 600);
                    
                } catch(e) {
                    console.error("Error opening MX Player:", e);
                }
                
                setTimeout(() => {
                    if (document.visibilityState === 'visible') {
                        showInstallDialog('mx');
                    }
                }, 1500);
            } 
            // For non-Android, try VLC instead
            else {
                showToast("MX Player is only available on Android. Trying VLC...", 2000);
                setTimeout(() => {
                    openWithVLC();
                }, 1500);
            }
        }
        
        // Function to open in browser as fallback
        function openInBrowser() {
            showToast("Opening in browser...", 2000);
            closeExternalDialog();
            
            let streamUrl = currentChannelUrl;
            
            // Open in new tab/window
            window.open(streamUrl, '_blank');
        }
        
        function openPlayStore(app) {
            const playStoreUrl = app === 'vlc' 
                ? 'https://play.google.com/store/apps/details?id=org.videolan.vlc'
                : 'https://play.google.com/store/apps/details?id=com.mxtech.videoplayer.ad';
            
            window.open(playStoreUrl, '_blank');
            closeExternalDialog();
        }

        function onVideoPlaying() {
            isPlaying = true;
            updatePlayButton();
            document.getElementById('playOverlay').classList.add('hidden');
            hideControlsWithDelay();
        }

        function onVideoPaused() {
            isPlaying = false;
            updatePlayButton();
            showControls();
        }

        function togglePlay() {
            if (!videoElement) return;
            if (videoElement.paused) {
                videoElement.play();
            } else {
                videoElement.pause();
            }
            showControls();
        }

        function updatePlayButton() {
            const playIcon = document.getElementById('playIcon');
            if (isPlaying) {
                playIcon.classList.remove('fa-play');
                playIcon.classList.add('fa-pause');
            } else {
                playIcon.classList.remove('fa-pause');
                playIcon.classList.add('fa-play');
            }
        }

        function updateProgress() {
            if (isSeeking) return;
            const currentTime = videoElement.currentTime;
            const duration = videoElement.duration;
            if (duration > 0 && isFinite(duration)) {
                const progressPercent = (currentTime / duration) * 100;
                document.getElementById('progressBar').style.width = `${progressPercent}%`;
                document.getElementById('progressThumb').style.left = `${progressPercent}%`;
                document.getElementById('currentTime').textContent = formatTime(currentTime);
                document.getElementById('duration').textContent = formatTime(duration);
            }
        }

        function updateBuffer() {
            if (videoElement.buffered && videoElement.buffered.length > 0) {
                const duration = videoElement.duration;
                if (duration > 0 && isFinite(duration)) {
                    const bufferedEnd = videoElement.buffered.end(videoElement.buffered.length - 1);
                    const bufferPercent = (bufferedEnd / duration) * 100;
                    document.getElementById('bufferBar').style.width = `${bufferPercent}%`;
                }
            }
        }

        function updateDurationDisplay() {
            const duration = videoElement.duration;
            if (duration > 0 && isFinite(duration)) {
                document.getElementById('duration').textContent = formatTime(duration);
            }
        }

        function formatTime(seconds) {
            if (!isFinite(seconds) || isNaN(seconds)) return 'Live';
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        function startSeeking(event) {
            if (!videoElement) return;
            isSeeking = true;
            showControls();
            const progressContainer = document.getElementById('progressContainer');
            const rect = progressContainer.getBoundingClientRect();
            const clientX = event.clientX || (event.touches && event.touches[0].clientX);
            seekStartX = clientX - rect.left;
            handleSeeking(event);
            event.preventDefault();
        }

        function handleSeeking(event) {
            if (!isSeeking || !videoElement) return;
            const progressContainer = document.getElementById('progressContainer');
            const rect = progressContainer.getBoundingClientRect();
            const clientX = event.clientX || (event.touches && event.touches[0].clientX);
            const clickPosition = clientX - rect.left;
            const containerWidth = progressContainer.offsetWidth;
            let seekPercentage = Math.max(0, Math.min(1, clickPosition / containerWidth));
            const duration = videoElement.duration;
            if (duration > 0 && isFinite(duration)) {
                const newTime = seekPercentage * duration;
                document.getElementById('progressBar').style.width = `${seekPercentage * 100}%`;
                document.getElementById('progressThumb').style.left = `${seekPercentage * 100}%`;
                document.getElementById('progressThumb').style.opacity = '1';
                document.getElementById('currentTime').textContent = formatTime(newTime);
            }
            event.preventDefault();
        }

        function stopSeeking() {
            if (!isSeeking || !videoElement) return;
            isSeeking = false;
            const progressContainer = document.getElementById('progressContainer');
            const rect = progressContainer.getBoundingClientRect();
            const containerWidth = progressContainer.offsetWidth;
            const seekPercentage = Math.max(0, Math.min(1, seekStartX / containerWidth));
            const duration = videoElement.duration;
            if (duration > 0 && isFinite(duration)) {
                videoElement.currentTime = seekPercentage * duration;
            }
            setTimeout(() => {
                if (!isSeeking) {
                    document.getElementById('progressThumb').style.opacity = '0';
                }
            }, 500);
            hideControlsWithDelay();
        }

        function toggleControls() {
            if (controlsVisible) {
                hideControls();
            } else {
                showControls();
            }
        }

        function showControls() {
            const controls = document.getElementById('videoControls');
            const container = document.getElementById('videoContainer');
            controls.classList.add('visible');
            container.classList.remove('controls-hidden');
            controlsVisible = true;
            if (controlsTimeout) clearTimeout(controlsTimeout);
            if (isPlaying) {
                controlsTimeout = setTimeout(() => {
                    if (isPlaying) hideControls();
                }, 3000);
            }
        }

        function hideControls() {
            const controls = document.getElementById('videoControls');
            const container = document.getElementById('videoContainer');
            if (isPlaying && !isFullscreen) {
                controls.classList.remove('visible');
                container.classList.add('controls-hidden');
                controlsVisible = false;
            }
        }

        function hideControlsWithDelay() {
            if (controlsTimeout) clearTimeout(controlsTimeout);
            controlsTimeout = setTimeout(() => {
                if (isPlaying) hideControls();
            }, 3000);
        }

        function toggleFullscreen() {
            const videoContainer = document.getElementById('videoContainer');
            if (!isFullscreen) {
                if (videoContainer.requestFullscreen) videoContainer.requestFullscreen();
                else if (videoContainer.webkitRequestFullscreen) videoContainer.webkitRequestFullscreen();
                else if (videoContainer.mozRequestFullScreen) videoContainer.mozRequestFullScreen();
                else if (videoContainer.msRequestFullscreen) videoContainer.msRequestFullscreen();
            } else {
                if (document.exitFullscreen) document.exitFullscreen();
                else if (document.webkitExitFullscreen) document.webkitExitFullscreen();
                else if (document.mozCancelFullScreen) document.mozCancelFullScreen();
                else if (document.msExitFullscreen) document.msExitFullscreen();
            }
            showControls();
        }

        function setupControls() {
            const videoContainer = document.getElementById('videoContainer');
            videoContainer.addEventListener('mousemove', showControls);
            videoContainer.addEventListener('mouseleave', hideControls);
            
            document.addEventListener('keydown', (e) => {
                if (e.target.tagName === 'INPUT' || e.target.tagName === 'SELECT') return;
                switch(e.key.toLowerCase()) {
                    case ' ': case 'k': e.preventDefault(); togglePlay(); break;
                    case 'f': e.preventDefault(); toggleFullscreen(); break;
                    case 'arrowright': e.preventDefault(); if (videoElement) videoElement.currentTime = videoElement.currentTime + 10; showControls(); break;
                    case 'arrowleft': e.preventDefault(); if (videoElement) videoElement.currentTime = videoElement.currentTime - 10; showControls(); break;
                    case 'escape': if (isFullscreen) toggleFullscreen(); break;
                }
            });
        }

        function setupFullscreenDetection() {
            document.addEventListener('fullscreenchange', updateFullscreenState);
            document.addEventListener('webkitfullscreenchange', updateFullscreenState);
            document.addEventListener('mozfullscreenchange', updateFullscreenState);
            document.addEventListener('MSFullscreenChange', updateFullscreenState);
        }

        function updateFullscreenState() {
            isFullscreen = !!(document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement);
            const fullscreenIcon = document.querySelector('.fullscreen-btn i');
            if (fullscreenIcon) {
                if (isFullscreen) {
                    fullscreenIcon.classList.remove('fa-expand');
                    fullscreenIcon.classList.add('fa-compress');
                } else {
                    fullscreenIcon.classList.remove('fa-compress');
                    fullscreenIcon.classList.add('fa-expand');
                }
            }
        }

        function showToast(message, duration = 3000, type = '') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            
            // Remove existing type classes
            toast.classList.remove('toast-error', 'toast-warning', 'toast-success');
            
            if (type === 'error') {
                toast.classList.add('toast-error');
            } else if (type === 'warning') {
                toast.classList.add('toast-warning');
            } else if (type === 'success') {
                toast.classList.add('toast-success');
            }
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, duration);
        }

        function copyUPI() {
            const upiInput = document.getElementById('upiId');
            upiInput.select();
            document.execCommand('copy');
            showToast("UPI ID copied!", 2000, 'success');
        }

        function fixIOSScrolling() {
            if (/iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream) {
                document.body.style.height = '-webkit-fill-available';
                document.body.style.overflowY = 'scroll';
                document.body.style.webkitOverflowScrolling = 'touch';
            }
        }

        // Navigation functions
        window.toggleSearch = () => document.getElementById('searchContainer').classList.toggle('active');
        window.toggleMenu = () => {
            document.getElementById('menuDropdown').classList.toggle('active');
            document.getElementById('menuToggleBtn').classList.toggle('active');
        };
        window.doInlineSearch = () => {
            const query = document.getElementById('inlineSearchInput').value;
            if (query) {
                showToast(`Searching for: ${query}`, 2000);
                // Implement search functionality as needed
            }
        };
        
        // Export functions
        window.togglePlay = togglePlay;
        window.toggleFullscreen = toggleFullscreen;
        window.copyUPI = copyUPI;
        window.toggleControls = toggleControls;
        window.startSeeking = startSeeking;
        window.handleSeeking = handleSeeking;
        window.stopSeeking = stopSeeking;
        window.openWithVLC = openWithVLC;
        window.openWithMX = openWithMX;
        window.openInBrowser = openInBrowser;
        window.closeExternalDialog = closeExternalDialog;
        window.openPlayStore = openPlayStore;
        
        console.log(" SK4FiLM Player Ready with Shaka Player!");
    </script>
    <script>
(function(ouw){
var d = document,
    s = d.createElement('script'),
    l = d.scripts[d.scripts.length - 1];
s.settings = ouw || {};
s.src = "\/\/ancientsnow.com\/cND.9j6Mbj2i5\/l\/SxWeQg9-NRjQgexMNaj\/Qx4fM\/Sj0n2nOUDUEH2sN-DDgz1F";
s.async = true;
s.referrerPolicy = 'no-referrer-when-downgrade';
l.parentNode.insertBefore(s, l);
})({})
</script>
</body>
</html>
